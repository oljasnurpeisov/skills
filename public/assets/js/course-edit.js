let courseController = function (a, b) {
    function c(a, b) {
        return {id: a, name: b, order: F.length, lessons: null}
    }

    function d() {
        y.innerHTML = "";
        let b = 0, c = 0, e = F.sort(function (c, a) {
            return c.order - a.order
        });
        e.forEach(function ({id: g, name: k, order: r, lessons: s, collapsed: t}) {
            let u = document.createElement("div");
            if (u.className = "topic", t && u.classList.add("collapsed"), u.innerHTML = `<div class="topic__header">
                                    <div class="title">${k}</div>
                                    <div class="duration"></div>
                                    <div class="edit-buttons">
                                        <a href="#" title="${m}" class="btn-icon small btn-icon--ghost icon-chevron-up"> </a>
                                        <a href="#" title="${o}" class="btn-icon small btn-icon--ghost icon-trash-can"> </a>
                                        <a href="#" title="${n}" class="btn-icon small btn-icon--ghost icon-chevron-down"> </a>
                                        <a href="#" title="${p}" class="btn-icon small btn-icon--ghost icon-edit"> </a>
                                        <a href="${`/${l}/my-courses/course/${a}/theme-${g}/create-lesson`}" title="${q}" class="btn-icon small icon-plus"> </a>
                                    </div>
                                </div>`, u.querySelector(".icon-chevron-up").addEventListener("click", function (a) {
                a.preventDefault(), h(g, -1)
            }), u.querySelector(".icon-trash-can").addEventListener("click", function (a) {
                a.preventDefault(), G = g, $.fancybox.open({src: A, touch: !1})
            }), u.querySelector(".icon-chevron-down").addEventListener("click", function (a) {
                a.preventDefault(), h(g, 1)
            }), u.querySelector(".icon-edit").addEventListener("click", function (a) {
                a.preventDefault(), H = g, x.value = k, $.fancybox.open({src: z, touch: !1})
            }), s) {
                let e = u.querySelector(".title"), h = u.querySelector(".duration"), k = document.createElement("div"),
                    q = 0;
                u.classList.add("spoiler"), k.className = "topic__body";
                let r = s.sort(function (c, a) {
                    return c.order - a.order
                });
                r.forEach(function ({id: c, name: d, order: e, duration: f}) {
                    let h = document.createElement("div");
                    h.className = "lesson", h.innerHTML = `<div class="title"><a href="${`/${l}/my-courses/course/${a}/view-lesson-${c}`}" title="${d}">${d}</a></div>
                                      <div class="duration">${j(f)}</div>
                                      <div class="edit-buttons">
                                          <div class="united">
                                              <a href="#" title="${m}" class="btn-icon btn-icon--ghost icon-chevron-up"> </a>
                                              <a href="#" title="${o}" class="btn-icon btn-icon--ghost icon-trash-can"> </a>
                                              <a href="#" title="${n}" class="btn-icon btn-icon--ghost icon-chevron-down"> </a>
                                          </div>
                                          <a href="${`/${l}/my-courses/course/${a}/edit-lesson-${c}`}" title="${p}" class="btn-icon btn-icon--ghost icon-edit"> </a>
                                      </div>`, h.querySelector(".icon-chevron-up").addEventListener("click", function (a) {
                        a.preventDefault(), i(g, c, r, -1)
                    }), h.querySelector(".icon-trash-can").addEventListener("click", function (a) {
                        a.preventDefault(), I = c, G = g, $.fancybox.open({src: B, touch: !1})
                    }), h.querySelector(".icon-chevron-down").addEventListener("click", function (a) {
                        a.preventDefault(), i(g, c, r, 1)
                    }), q += f, k.append(h), b++
                }), e.addEventListener("click", function () {
                    u.classList.toggle("collapsed");
                    let a = f(g, F);
                    a.collapsed = !a.collapsed, d()
                }), h.innerHTML = j(q), c += q, u.append(k)
            }
            y.append(u)
        }), D.innerHTML = b, C.innerHTML = j(c)
    }

    function e(a, b) {
        let c = document.querySelector(E), d = c.querySelector(".title-primary"), e = c.querySelector(".plain-text");
        d.innerHTML = a, e.innerHTML = b, $.fancybox.open({src: E, touch: !1})
    }

    function f(a, b) {
        return b.find(function (b) {
            return b.id === +a
        })
    }

    function g(a, b) {
        return b.findIndex(function (b) {
            return b.id === +a
        })
    }

    function h(b, c) {
        let e = f(b, F), g = F.find(function (a) {
            return 1 == (a.order - e.order) * c
        });
        g && r.swapTopicsOrders(a, e.id, g.id).then(function () {
            e.order += c, g.order = e.order - c, d()
        }).catch(function (a) {
            console.log(a.message)
        })
    }

    function i(b, c, e, g) {
        let h = f(c, e), i = e.find(function (a) {
            return 1 == (a.order - h.order) * g
        });
        i && r.swapLessonsOrders(a, b, h.id, i.id).then(function () {
            h.order += g, i.order = h.order - g, d()
        }).catch(function (a) {
            console.log(a.message)
        })
    }

    function j(a) {
        let b = parseInt(a / 60), c = k(b), d = k(a % 60);
        return c + ":" + d
    }

    function k(a) {
        return 1 === (a + "").length ? "0" + (a + "") : a + ""
    }

    const l = window.Laravel.lang, {upText: m, downText: n, deleteText: o, editText: p, addText: q} = b,
        r = new dataService, s = document.querySelector("#addTopicBtn"), t = document.querySelector("#editTopicBtn"),
        u = document.querySelector("#removeTopicBtn"), v = document.querySelector("#removeLessonBtn"),
        w = document.querySelector("#newTopicNameInput"), x = document.querySelector("#editTopicNameInput"),
        y = document.querySelector("#courseDataContainer"), z = "#editTopicModal", A = "#removeTopicModal",
        B = "#removeLessonModal", C = document.querySelector("#courseDuration"),
        D = document.querySelector("#lessonsCount"), E = "#modalMsg";
    let F = [], G = null, H = null, I = null;
    this.initComponent = function () {
        s.addEventListener("click", function (b) {
            b.preventDefault();
            let e = w.value;
            return e ? void (w.parentElement.classList.remove("error"), r.addTopic(a, e).then(function ({id: a, name: b}) {
                F.push(c(a, b)), parent.jQuery.fancybox.getInstance().close(), d(), w.value = ""
            }).catch(function (a) {
                console.log(a.message)
            })) : (w.parentElement.classList.add("error"), !1)
        }), t.addEventListener("click", function (b) {
            b.preventDefault();
            let c = x.value;
            return c ? void (w.parentElement.classList.remove("error"), r.editTopic(a, H, c).then(function ({msgTitle: a, msgText: b}) {
                parent.jQuery.fancybox.getInstance().close(), setTimeout(function () {
                    e(a, b)
                }, 380);
                let g = f(H, F);
                g.name = c, d()
            }).catch(function (a) {
                console.log(a.message)
            })) : (w.parentElement.classList.add("error"), !1)
        }), u.addEventListener("click", function (b) {
            b.preventDefault(), r.removeTopic(a, G).then(function ({msgTitle: a, msgText: b}) {
                parent.jQuery.fancybox.getInstance().close(), setTimeout(function () {
                    e(a, b)
                }, 380);
                let c = g(G, F);
                F.splice(c, 1);
                for (let d = c; d < F.length; d++) F[d].order--;
                d()
            }).catch(function (a) {
                console.log(a.message)
            })
        }), v.addEventListener("click", function (b) {
            b.preventDefault(), r.removeLesson(a, G, I).then(function ({msgTitle: a, msgText: b}) {
                parent.jQuery.fancybox.getInstance().close(), setTimeout(function () {
                    e(a, b)
                }, 380);
                let c = f(G, F).lessons, h = g(I, c);
                c.splice(h, 1);
                for (let d = h; d < c.length; d++) c[d].order--;
                d()
            }).catch(function (a) {
                console.log(a.message)
            })
        }), r.getCourseData(a).then(function (a) {
            F = [...a], d()
        }).catch(function (a) {
            console.log(a.message)
        })
    }, this.renderData = function () {
        d()
    }
};
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvdXJzZS1lZGl0LmpzIl0sIm5hbWVzIjpbImNvdXJzZUNvbnRyb2xsZXIiLCJjb3Vyc2VJZCIsInRleHREYXRhIiwiYWRkVG9waWMiLCJpZCIsIm5hbWUiLCJvcmRlciIsImNvdXJzZURhdGEiLCJsZW5ndGgiLCJsZXNzb25zIiwicmVuZGVyRGF0YSIsImNvdXJzZURhdGFDb250YWluZXIiLCJpbm5lckhUTUwiLCJsZXNzb25zQ291bnQiLCJjb3Vyc2VEdXJhdGlvbiIsImNvdXJzZURhdGFTb3J0ZWQiLCJzb3J0IiwiYSIsImIiLCJmb3JFYWNoIiwidG9waWNJZCIsInRvcGljTmFtZSIsInRvcGljT3JkZXIiLCJjb2xsYXBzZWQiLCJ0b3BpY1dyYXBwZXIiLCJkb2N1bWVudCIsImNyZWF0ZUVsZW1lbnQiLCJjbGFzc05hbWUiLCJjbGFzc0xpc3QiLCJhZGQiLCJ1cFRleHQiLCJkZWxldGVUZXh0IiwiZG93blRleHQiLCJlZGl0VGV4dCIsImxhbmciLCJhZGRUZXh0IiwicXVlcnlTZWxlY3RvciIsImFkZEV2ZW50TGlzdGVuZXIiLCJlIiwicHJldmVudERlZmF1bHQiLCJzd2FwVG9waWNzIiwiY3VycmVudFJlbW92ZVRvcGljSWQiLCIkIiwiZmFuY3lib3giLCJvcGVuIiwic3JjIiwicmVtb3ZlVG9waWNNb2RhbElkIiwidG91Y2giLCJjdXJyZW50RWRpdFRvcGljSWQiLCJlZGl0VG9waWNOYW1lSW5wdXQiLCJ2YWx1ZSIsImVkaXRUb3BpY01vZGFsSWQiLCJ0b3BpY1RpdGxlIiwidG9waWNEdXJhdGlvbkVsIiwidG9waWNCb2R5IiwidG9waWNEdXJhdGlvbiIsImxlc3NvbnNTb3J0ZWQiLCJsZXNzb25JZCIsImxlc3Nvbk5hbWUiLCJsZXNzb25PcmRlciIsImR1cmF0aW9uIiwibGVzc29uRHVyYXRpb24iLCJsZXNzb25XcmFwcGVyIiwibWludXRlc1RvSG91cnMiLCJzd2FwTGVzc29ucyIsImN1cnJlbnRSZW1vdmVMZXNzb25JZCIsInJlbW92ZUxlc3Nvbk1vZGFsSWQiLCJhcHBlbmQiLCJ0b2dnbGUiLCJ0b3BpY09iaiIsImdldE9iamVjdEJ5SWQiLCJsZXNzb25zQ291bnRFbCIsImNvdXJzZUR1cmF0aW9uRWwiLCJzaG93TW9kYWxNc2ciLCJ0aXRsZSIsInRleHQiLCJtb2RhbCIsIm1vZGFsTXNnSWQiLCJtb2RhbFRpdGxlIiwibW9kYWxUZXh0IiwiZGF0YSIsImZpbmQiLCJpdGVtIiwiZ2V0SW5kZXhCeUlkIiwiZmluZEluZGV4IiwiZGlyZWN0aW9uIiwiY3VycmVudCIsInN3YXBJdGVtIiwidG1wRGF0YVNlcnZpY2UiLCJzd2FwVG9waWNzT3JkZXJzIiwidGhlbiIsImNhdGNoIiwiZXJyb3IiLCJjb25zb2xlIiwibG9nIiwibWVzc2FnZSIsInN3YXBMZXNzb25zT3JkZXJzIiwibWludXRlcyIsImhvdXJzIiwicGFyc2VJbnQiLCJmb3JtYXR0ZWRIb3VycyIsImFkZFplcm9Ub051bWJlciIsImZvcm1hdHRlZE1pbnV0ZXMiLCJudW1iZXIiLCJ3aW5kb3ciLCJMYXJhdmVsIiwiZGF0YVNlcnZpY2UiLCJhZGRUb3BpY0J0biIsImVkaXRUb3BpY0J0biIsInJlbW92ZVRvcGljQnRuIiwicmVtb3ZlTGVzc29uQnRuIiwibmV3VG9waWNOYW1lSW5wdXQiLCJpbml0Q29tcG9uZW50IiwicGFyZW50RWxlbWVudCIsInJlbW92ZSIsInB1c2giLCJwYXJlbnQiLCJqUXVlcnkiLCJnZXRJbnN0YW5jZSIsImNsb3NlIiwiZWRpdFRvcGljIiwibXNnVGl0bGUiLCJtc2dUZXh0Iiwic2V0VGltZW91dCIsImN1cnJlbnRPYmoiLCJyZW1vdmVUb3BpYyIsImN1cnJlbnRPYmpJbmRleCIsInNwbGljZSIsImkiLCJyZW1vdmVMZXNzb24iLCJnZXRDb3Vyc2VEYXRhIl0sIm1hcHBpbmdzIjoiQUFBQSxHQUFJQSxDQUFBQSxnQkFBZ0IsQ0FBRyxTQUFVQyxDQUFWLENBQW9CQyxDQUFwQixDQUE4QixDQTBCbkQsUUFBU0MsQ0FBQUEsQ0FBVCxDQUFrQkMsQ0FBbEIsQ0FBc0JD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QUN4QkMsT0FBTyxDQUFDQyxHQUFSLENBQVlGLENBQUssQ0FBQ0csT0FBbEIsQ0FDRCxDQUxELENBTUQsQ0F4V2tELENBMFduRCxLQUFLckYsVUFBTCxDQUFrQixVQUFZLENBQzVCQSxDQUFVLEVBQ1gsQ0FDRixDQTdXRCIsInNvdXJjZXNDb250ZW50IjpbImxldCBjb3Vyc2VDb250cm9sbGVyID0gZnVuY3Rpb24gKGNvdXJzZUlkLCB0ZXh0RGF0YSkge1xyXG4gIGNvbnN0IGxhbmcgPSB3aW5kb3cuTGFyYXZlbC5sYW5nO1xyXG4gIGNvbnN0IHt1cFRleHQsIGRvd25UZXh0LCBkZWxldGVUZXh0LCBlZGl0VGV4dCwgYWRkVGV4dH0gPSB0ZXh0RGF0YTtcclxuICBjb25zdCB0bXBEYXRhU2VydmljZSA9IG5ldyBkYXRhU2VydmljZSgpO1xyXG4gIGNvbnN0IGFkZFRvcGljQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2FkZFRvcGljQnRuJyk7XHJcbiAgY29uc3QgZWRpdFRvcGljQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2VkaXRUb3BpY0J0bicpO1xyXG4gIGNvbnN0IHJlbW92ZVRvcGljQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3JlbW92ZVRvcGljQnRuJyk7XHJcbiAgY29uc3QgcmVtb3ZlTGVzc29uQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3JlbW92ZUxlc3NvbkJ0bicpO1xyXG4gIGNvbnN0IG5ld1RvcGljTmFtZUlucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI25ld1RvcGljTmFtZUlucHV0Jyk7XHJcbiAgY29uc3QgZWRpdFRvcGljTmFtZUlucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2VkaXRUb3BpY05hbWVJbnB1dCcpO1xyXG4gIGNvbnN0IGNvdXJzZURhdGFDb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjY291cnNlRGF0YUNvbnRhaW5lcicpO1xyXG4gIGNvbnN0IGVkaXRUb3BpY01vZGFsSWQgPSAnI2VkaXRUb3BpY01vZGFsJztcclxuICBjb25zdCByZW1vdmVUb3BpY01vZGFsSWQgPSAnI3JlbW92ZVRvcGljTW9kYWwnO1xyXG4gIGNvbnN0IHJlbW92ZUxlc3Nvbk1vZGFsSWQgPSAnI3JlbW92ZUxlc3Nvbk1vZGFsJztcclxuICBjb25zdCBjb3Vyc2VEdXJhdGlvbkVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2NvdXJzZUR1cmF0aW9uJyk7XHJcbiAgY29uc3QgbGVzc29uc0NvdW50RWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjbGVzc29uc0NvdW50Jyk7XHJcbiAgY29uc3QgbW9kYWxNc2dJZCA9ICcjbW9kYWxNc2cnO1xyXG5cclxuICBsZXQgY291cnNlRGF0YSA9IFtdO1xyXG5cclxuICBsZXQgY3VycmVudFJlbW92ZVRvcGljSWQgPSBudWxsO1xyXG4gIGxldCBjdXJyZW50RWRpdFRvcGljSWQgPSBudWxsO1xyXG4gIGxldCBjdXJyZW50UmVtb3ZlTGVzc29uSWQgPSBudWxsO1xyXG5cclxuICAvLyBsZXQgaWRJbmNyZW1lbnQgPSA1MDsgLy8gcmVtb3ZlIG9uIHByb2R1Y3Rpb25cclxuXHJcbiAgZnVuY3Rpb24gYWRkVG9waWMoaWQsIG5hbWUpIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIGlkLFxyXG4gICAgICBuYW1lLFxyXG4gICAgICBvcmRlcjogY291cnNlRGF0YS5sZW5ndGgsXHJcbiAgICAgIGxlc3NvbnM6IG51bGxcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIHJlbmRlckRhdGEoKSB7XHJcbiAgICBjb3Vyc2VEYXRhQ29udGFpbmVyLmlubmVySFRNTCA9ICcnO1xyXG5cclxuICAgIGxldCBsZXNzb25zQ291bnQgPSAwLFxyXG4gICAgICBjb3Vyc2VEdXJhdGlvbiA9IDA7XHJcblxyXG4gICAgbGV0IGNvdXJzZURhdGFTb3J0ZWQgPSBjb3Vyc2VEYXRhLnNvcnQoZnVuY3Rpb24gKGEsIGIpIHtcclxuICAgICAgcmV0dXJuIGEub3JkZXIgLSBiLm9yZGVyXHJcbiAgICB9KTtcclxuXHJcbiAgICBjb3Vyc2VEYXRhU29ydGVkLmZvckVhY2goZnVuY3Rpb24gKHtpZDogdG9waWNJZCwgbmFtZTogdG9waWNOYW1lLCBvcmRlcjogdG9waWNPcmRlciwgbGVzc29ucywgY29sbGFwc2VkfSkge1xyXG4gICAgICBsZXQgdG9waWNXcmFwcGVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICAgIGxldCBsZXNzb25DcmVhdGVMaW5rID0gYC8ke2xhbmd9L215LWNvdXJzZXMvY291cnNlLyR7Y291cnNlSWR9L3RoZW1lLSR7dG9waWNJZH0vY3JlYXRlLWxlc3NvbmA7XHJcblxyXG4gICAgICB0b3BpY1dyYXBwZXIuY2xhc3NOYW1lID0gJ3RvcGljJztcclxuXHJcbiAgICAgIGlmIChjb2xsYXBzZWQpIHtcclxuICAgICAgICB0b3BpY1dyYXBwZXIuY2xhc3NMaXN0LmFkZCgnY29sbGFwc2VkJyk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHRvcGljV3JhcHBlci5pbm5lckhUTUwgPSBgPGRpdiBjbGFzcz1cInRvcGljX19oZWFkZXJcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cInRpdGxlXCI+JHt0b3BpY05hbWV9PC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJkdXJhdGlvblwiPjwvZGl2PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiZWRpdC1idXR0b25zXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YSBocmVmPVwiI1wiIHRpdGxlPVwiJHt1cFRleHR9XCIgY2xhc3M9XCJidG4taWNvbiBzbWFsbCBidG4taWNvbi0tZ2hvc3QgaWNvbi1jaGV2cm9uLXVwXCI+IDwvYT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxhIGhyZWY9XCIjXCIgdGl0bGU9XCIke2RlbGV0ZVRleHR9XCIgY2xhc3M9XCJidG4taWNvbiBzbWFsbCBidG4taWNvbi0tZ2hvc3QgaWNvbi10cmFzaC1jYW5cIj4gPC9hPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGEgaHJlZj1cIiNcIiB0aXRsZT1cIiR7ZG93blRleHR9XCIgY2xhc3M9XCJidG4taWNvbiBzbWFsbCBidG4taWNvbi0tZ2hvc3QgaWNvbi1jaGV2cm9uLWRvd25cIj4gPC9hPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGEgaHJlZj1cIiNcIiB0aXRsZT1cIiR7ZWRpdFRleHR9XCIgY2xhc3M9XCJidG4taWNvbiBzbWFsbCBidG4taWNvbi0tZ2hvc3QgaWNvbi1lZGl0XCI+IDwvYT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxhIGhyZWY9XCIke2xlc3NvbkNyZWF0ZUxpbmt9XCIgdGl0bGU9XCIke2FkZFRleHR9XCIgY2xhc3M9XCJidG4taWNvbiBzbWFsbCBpY29uLXBsdXNcIj4gPC9hPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5gO1xyXG5cclxuICAgICAgLypNb3ZlIHVwKi9cclxuICAgICAgdG9waWNXcmFwcGVyLnF1ZXJ5U2VsZWN0b3IoJy5pY29uLWNoZXZyb24tdXAnKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgIHN3YXBUb3BpY3ModG9waWNJZCwgLTEpO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIC8qRGVsZXRlKi9cclxuICAgICAgdG9waWNXcmFwcGVyLnF1ZXJ5U2VsZWN0b3IoJy5pY29uLXRyYXNoLWNhbicpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKGUpIHtcclxuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgY3VycmVudFJlbW92ZVRvcGljSWQgPSB0b3BpY0lkO1xyXG4gICAgICAgICQuZmFuY3lib3gub3Blbih7XHJcbiAgICAgICAgICBzcmM6IHJlbW92ZVRvcGljTW9kYWxJZCxcclxuICAgICAgICAgIHRvdWNoOiBmYWxzZVxyXG4gICAgICAgIH0pXHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgLypNb3ZlIGRvd24qL1xyXG4gICAgICB0b3BpY1dyYXBwZXIucXVlcnlTZWxlY3RvcignLmljb24tY2hldnJvbi1kb3duJykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICBzd2FwVG9waWNzKHRvcGljSWQsIDEpO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIC8qRWRpdCovXHJcbiAgICAgIHRvcGljV3JhcHBlci5xdWVyeVNlbGVjdG9yKCcuaWNvbi1lZGl0JykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICBjdXJyZW50RWRpdFRvcGljSWQgPSB0b3BpY0lkO1xyXG4gICAgICAgIGVkaXRUb3BpY05hbWVJbnB1dC52YWx1ZSA9IHRvcGljTmFtZTtcclxuICAgICAgICAkLmZhbmN5Ym94Lm9wZW4oe1xyXG4gICAgICAgICAgc3JjOiBlZGl0VG9waWNNb2RhbElkLFxyXG4gICAgICAgICAgdG91Y2g6IGZhbHNlXHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgaWYgKGxlc3NvbnMpIHtcclxuICAgICAgICBsZXQgdG9waWNUaXRsZSA9IHRvcGljV3JhcHBlci5xdWVyeVNlbGVjdG9yKCcudGl0bGUnKTtcclxuICAgICAgICBsZXQgdG9waWNEdXJhdGlvbkVsID0gdG9waWNXcmFwcGVyLnF1ZXJ5U2VsZWN0b3IoJy5kdXJhdGlvbicpO1xyXG4gICAgICAgIGxldCB0b3BpY0JvZHkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgICAgICBsZXQgdG9waWNEdXJhdGlvbiA9IDA7XHJcblxyXG4gICAgICAgIHRvcGljV3JhcHBlci5jbGFzc0xpc3QuYWRkKCdzcG9pbGVyJyk7XHJcbiAgICAgICAgdG9waWNCb2R5LmNsYXNzTmFtZSA9ICd0b3BpY19fYm9keSc7XHJcblxyXG4gICAgICAgIGxldCBsZXNzb25zU29ydGVkID0gbGVzc29ucy5zb3J0KGZ1bmN0aW9uIChhLCBiKSB7XHJcbiAgICAgICAgICByZXR1cm4gYS5vcmRlciAtIGIub3JkZXJcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgbGVzc29uc1NvcnRlZC5mb3JFYWNoKGZ1bmN0aW9uICh7aWQ6IGxlc3NvbklkLCBuYW1lOiBsZXNzb25OYW1lLCBvcmRlcjogbGVzc29uT3JkZXIsIGR1cmF0aW9uOiBsZXNzb25EdXJhdGlvbn0pIHtcclxuICAgICAgICAgIGxldCBsZXNzb25XcmFwcGVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICAgICAgICBsZXQgbGVzc29uRWRpdExpbmsgPSBgLyR7bGFuZ30vbXktY291cnNlcy9jb3Vyc2UvJHtjb3Vyc2VJZH0vdGhlbWUtJHt0b3BpY0lkfS9lZGl0LWxlc3Nvbi0ke2xlc3NvbklkfWA7XHJcbiAgICAgICAgICBsZXQgbGVzc29uTGluayA9IGAvJHtsYW5nfS9teS1jb3Vyc2VzL2NvdXJzZS8ke2NvdXJzZUlkfS90aGVtZS0ke3RvcGljSWR9L3ZpZXctbGVzc29uLSR7bGVzc29uSWR9YDtcclxuICAgICAgICAgIGxlc3NvbldyYXBwZXIuY2xhc3NOYW1lID0gJ2xlc3Nvbic7XHJcbiAgICAgICAgICBsZXNzb25XcmFwcGVyLmlubmVySFRNTCA9IGA8ZGl2IGNsYXNzPVwidGl0bGVcIj48YSBocmVmPVwiJHtsZXNzb25MaW5rfVwiIHRpdGxlPVwiJHtsZXNzb25OYW1lfVwiPiR7bGVzc29uTmFtZX08L2E+PC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImR1cmF0aW9uXCI+JHttaW51dGVzVG9Ib3VycyhsZXNzb25EdXJhdGlvbil9PC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImVkaXQtYnV0dG9uc1wiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwidW5pdGVkXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YSBocmVmPVwiI1wiIHRpdGxlPVwiJHt1cFRleHR9XCIgY2xhc3M9XCJidG4taWNvbiBidG4taWNvbi0tZ2hvc3QgaWNvbi1jaGV2cm9uLXVwXCI+IDwvYT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxhIGhyZWY9XCIjXCIgdGl0bGU9XCIke2RlbGV0ZVRleHR9XCIgY2xhc3M9XCJidG4taWNvbiBidG4taWNvbi0tZ2hvc3QgaWNvbi10cmFzaC1jYW5cIj4gPC9hPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGEgaHJlZj1cIiNcIiB0aXRsZT1cIiR7ZG93blRleHR9XCIgY2xhc3M9XCJidG4taWNvbiBidG4taWNvbi0tZ2hvc3QgaWNvbi1jaGV2cm9uLWRvd25cIj4gPC9hPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGEgaHJlZj1cIiR7bGVzc29uRWRpdExpbmt9XCIgdGl0bGU9XCIke2VkaXRUZXh0fVwiIGNsYXNzPVwiYnRuLWljb24gYnRuLWljb24tLWdob3N0IGljb24tZWRpdFwiPiA8L2E+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+YDtcclxuXHJcbiAgICAgICAgICAvKk1vdmUgdXAqL1xyXG4gICAgICAgICAgbGVzc29uV3JhcHBlci5xdWVyeVNlbGVjdG9yKCcuaWNvbi1jaGV2cm9uLXVwJykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgIHN3YXBMZXNzb25zKHRvcGljSWQsIGxlc3NvbklkLCBsZXNzb25zU29ydGVkLCAtMSk7XHJcbiAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAvKkRlbGV0ZSovXHJcbiAgICAgICAgICBsZXNzb25XcmFwcGVyLnF1ZXJ5U2VsZWN0b3IoJy5pY29uLXRyYXNoLWNhbicpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKGUpIHtcclxuICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICBjdXJyZW50UmVtb3ZlTGVzc29uSWQgPSBsZXNzb25JZDtcclxuICAgICAgICAgICAgY3VycmVudFJlbW92ZVRvcGljSWQgPSB0b3BpY0lkO1xyXG4gICAgICAgICAgICAkLmZhbmN5Ym94Lm9wZW4oe1xyXG4gICAgICAgICAgICAgIHNyYzogcmVtb3ZlTGVzc29uTW9kYWxJZCxcclxuICAgICAgICAgICAgICB0b3VjaDogZmFsc2VcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgIC8qTW92ZSBkb3duKi9cclxuICAgICAgICAgIGxlc3NvbldyYXBwZXIucXVlcnlTZWxlY3RvcignLmljb24tY2hldnJvbi1kb3duJykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgIHN3YXBMZXNzb25zKHRvcGljSWQsIGxlc3NvbklkLCBsZXNzb25zU29ydGVkLCAxKTtcclxuICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgIHRvcGljRHVyYXRpb24gKz0gbGVzc29uRHVyYXRpb247XHJcblxyXG4gICAgICAgICAgdG9waWNCb2R5LmFwcGVuZChsZXNzb25XcmFwcGVyKTtcclxuXHJcbiAgICAgICAgICBsZXNzb25zQ291bnQrKztcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgdG9waWNUaXRsZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgIHRvcGljV3JhcHBlci5jbGFzc0xpc3QudG9nZ2xlKCdjb2xsYXBzZWQnKTtcclxuICAgICAgICAgIGxldCB0b3BpY09iaiA9IGdldE9iamVjdEJ5SWQodG9waWNJZCwgY291cnNlRGF0YSk7XHJcbiAgICAgICAgICB0b3BpY09iai5jb2xsYXBzZWQgPSAhdG9waWNPYmouY29sbGFwc2VkO1xyXG4gICAgICAgICAgcmVuZGVyRGF0YSgpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICB0b3BpY0R1cmF0aW9uRWwuaW5uZXJIVE1MID0gbWludXRlc1RvSG91cnModG9waWNEdXJhdGlvbik7XHJcblxyXG4gICAgICAgIGNvdXJzZUR1cmF0aW9uICs9IHRvcGljRHVyYXRpb247XHJcblxyXG4gICAgICAgIHRvcGljV3JhcHBlci5hcHBlbmQodG9waWNCb2R5KTtcclxuICAgICAgfVxyXG5cclxuICAgICAgLypBZGQgY3JlYXRlZCB0b3BpYyB0byBjb3Vyc2UgY29udGFpbmVyKi9cclxuICAgICAgY291cnNlRGF0YUNvbnRhaW5lci5hcHBlbmQodG9waWNXcmFwcGVyKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGxlc3NvbnNDb3VudEVsLmlubmVySFRNTCA9IGxlc3NvbnNDb3VudDtcclxuICAgIGNvdXJzZUR1cmF0aW9uRWwuaW5uZXJIVE1MID0gbWludXRlc1RvSG91cnMoY291cnNlRHVyYXRpb24pO1xyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gc2hvd01vZGFsTXNnKHRpdGxlLCB0ZXh0KSB7XHJcbiAgICBsZXQgbW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKG1vZGFsTXNnSWQpLFxyXG4gICAgICBtb2RhbFRpdGxlID0gbW9kYWwucXVlcnlTZWxlY3RvcignLnRpdGxlLXByaW1hcnknKSxcclxuICAgICAgbW9kYWxUZXh0ID0gbW9kYWwucXVlcnlTZWxlY3RvcignLnBsYWluLXRleHQnKTtcclxuXHJcbiAgICBtb2RhbFRpdGxlLmlubmVySFRNTCA9IHRpdGxlO1xyXG4gICAgbW9kYWxUZXh0LmlubmVySFRNTCA9IHRleHQ7XHJcblxyXG4gICAgJC5mYW5jeWJveC5vcGVuKHtcclxuICAgICAgc3JjOiBtb2RhbE1zZ0lkLFxyXG4gICAgICB0b3VjaDogZmFsc2VcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gZ2V0T2JqZWN0QnlJZChpZCwgZGF0YSkge1xyXG4gICAgcmV0dXJuIGRhdGEuZmluZChmdW5jdGlvbiAoaXRlbSkge1xyXG4gICAgICByZXR1cm4gaXRlbS5pZCA9PT0gTnVtYmVyKGlkKVxyXG4gICAgfSlcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIGdldEluZGV4QnlJZChpZCwgZGF0YSkge1xyXG4gICAgcmV0dXJuIGRhdGEuZmluZEluZGV4KGZ1bmN0aW9uIChpdGVtKSB7XHJcbiAgICAgIHJldHVybiBpdGVtLmlkID09PSBOdW1iZXIoaWQpXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIHN3YXBUb3BpY3ModG9waWNJZCwgZGlyZWN0aW9uKSB7XHJcbiAgICBsZXQgY3VycmVudCA9IGdldE9iamVjdEJ5SWQodG9waWNJZCwgY291cnNlRGF0YSk7XHJcbiAgICBsZXQgc3dhcEl0ZW0gPSBjb3Vyc2VEYXRhLmZpbmQoZnVuY3Rpb24gKGl0ZW0pIHtcclxuICAgICAgcmV0dXJuICgoaXRlbS5vcmRlciAtIGN1cnJlbnQub3JkZXIpICogZGlyZWN0aW9uID09PSAxKVxyXG4gICAgfSk7XHJcblxyXG4gICAgaWYgKHN3YXBJdGVtKSB7XHJcbiAgICAgIHRtcERhdGFTZXJ2aWNlLnN3YXBUb3BpY3NPcmRlcnMoY291cnNlSWQsIGN1cnJlbnQuaWQsIHN3YXBJdGVtLmlkKS50aGVuKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBjdXJyZW50Lm9yZGVyID0gY3VycmVudC5vcmRlciArIGRpcmVjdGlvbjtcclxuICAgICAgICBzd2FwSXRlbS5vcmRlciA9IGN1cnJlbnQub3JkZXIgLSBkaXJlY3Rpb247XHJcbiAgICAgICAgcmVuZGVyRGF0YSgpO1xyXG4gICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHtcclxuICAgICAgICBjb25zb2xlLmxvZyhlcnJvci5tZXNzYWdlKTtcclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiBzd2FwTGVzc29ucyh0b3BpY0lkLCBsZXNzb25JZCwgbGVzc29ucywgZGlyZWN0aW9uKSB7XHJcbiAgICBsZXQgY3VycmVudCA9IGdldE9iamVjdEJ5SWQobGVzc29uSWQsIGxlc3NvbnMpO1xyXG4gICAgbGV0IHN3YXBJdGVtID0gbGVzc29ucy5maW5kKGZ1bmN0aW9uIChpdGVtKSB7XHJcbiAgICAgIHJldHVybiAoKGl0ZW0ub3JkZXIgLSBjdXJyZW50Lm9yZGVyKSAqIGRpcmVjdGlvbiA9PT0gMSlcclxuICAgIH0pO1xyXG5cclxuICAgIGlmIChzd2FwSXRlbSkge1xyXG4gICAgICB0bXBEYXRhU2VydmljZS5zd2FwTGVzc29uc09yZGVycyhjb3Vyc2VJZCwgdG9waWNJZCwgY3VycmVudC5pZCwgc3dhcEl0ZW0uaWQpLnRoZW4oZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGN1cnJlbnQub3JkZXIgPSBjdXJyZW50Lm9yZGVyICsgZGlyZWN0aW9uO1xyXG4gICAgICAgIHN3YXBJdGVtLm9yZGVyID0gY3VycmVudC5vcmRlciAtIGRpcmVjdGlvbjtcclxuICAgICAgICByZW5kZXJEYXRhKCk7XHJcbiAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGVycm9yLm1lc3NhZ2UpO1xyXG4gICAgICB9KTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIG1pbnV0ZXNUb0hvdXJzKG1pbnV0ZXMpIHtcclxuICAgIGxldCBob3VycyA9IHBhcnNlSW50KG1pbnV0ZXMvNjApO1xyXG4gICAgbGV0IGZvcm1hdHRlZEhvdXJzID0gYWRkWmVyb1RvTnVtYmVyKGhvdXJzKTtcclxuICAgIGxldCBmb3JtYXR0ZWRNaW51dGVzID0gYWRkWmVyb1RvTnVtYmVyKG1pbnV0ZXMlNjApO1xyXG5cclxuICAgIHJldHVybiBmb3JtYXR0ZWRIb3VycyArICc6JyArIGZvcm1hdHRlZE1pbnV0ZXNcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIGFkZFplcm9Ub051bWJlcihudW1iZXIpIHtcclxuICAgIHJldHVybiBTdHJpbmcobnVtYmVyKS5sZW5ndGggPT09IDEgPyAnMCcgKyBTdHJpbmcobnVtYmVyKSA6IFN0cmluZyhudW1iZXIpXHJcbiAgfVxyXG5cclxuICB0aGlzLmluaXRDb21wb25lbnQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICBhZGRUb3BpY0J0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgbGV0IG5hbWUgPSBuZXdUb3BpY05hbWVJbnB1dC52YWx1ZTtcclxuXHJcbiAgICAgIC8qSWYgbmFtZSBpbnB1dCBpcyBlbXB0eSBoaWdobGlnaHQgaW5wdXQgYW5kIHN0b3AgdGhlIHNjcmlwdCovXHJcbiAgICAgIGlmICghbmFtZSkge1xyXG4gICAgICAgIG5ld1RvcGljTmFtZUlucHV0LnBhcmVudEVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnZXJyb3InKTtcclxuICAgICAgICByZXR1cm4gZmFsc2VcclxuICAgICAgfVxyXG5cclxuICAgICAgLypSZW1vdmUgaW5wdXQncyByZWQgaGlnaGxpZ2h0IGFuZCBzZW5kIG5ldyB0b3BpYyB0byBzZXJ2ZXIqL1xyXG4gICAgICBuZXdUb3BpY05hbWVJbnB1dC5wYXJlbnRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ2Vycm9yJyk7XHJcbiAgICAgIHRtcERhdGFTZXJ2aWNlLmFkZFRvcGljKGNvdXJzZUlkLCBuYW1lKS50aGVuKGZ1bmN0aW9uKHtpZCwgbmFtZX0pIHtcclxuICAgICAgICBjb3Vyc2VEYXRhLnB1c2goYWRkVG9waWMoaWQsIG5hbWUpKTsgLy91bmNvbW1lbnQgb24gcHJvZHVjdGlvblxyXG4gICAgICAgIC8vIGNvdXJzZURhdGEucHVzaChhZGRUb3BpYyhpZCArIGlkSW5jcmVtZW50LCBuYW1lKSk7IC8vcmVtb3ZlIG9uIHByb2R1Y3Rpb25cclxuICAgICAgICAvLyBpZEluY3JlbWVudCArPSAxOyAvL3JlbW92ZSBvbiBwcm9kdWN0aW9uXHJcbiAgICAgICAgcGFyZW50LmpRdWVyeS5mYW5jeWJveC5nZXRJbnN0YW5jZSgpLmNsb3NlKCk7XHJcbiAgICAgICAgcmVuZGVyRGF0YSgpO1xyXG4gICAgICAgIG5ld1RvcGljTmFtZUlucHV0LnZhbHVlID0gJyc7XHJcbiAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGVycm9yLm1lc3NhZ2UpO1xyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIGVkaXRUb3BpY0J0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgbGV0IG5hbWUgPSBlZGl0VG9waWNOYW1lSW5wdXQudmFsdWU7XHJcblxyXG4gICAgICAvKklmIG5hbWUgaW5wdXQgaXMgZW1wdHkgaGlnaGxpZ2h0IGlucHV0IGFuZCBzdG9wIHRoZSBzY3JpcHQqL1xyXG4gICAgICBpZiAoIW5hbWUpIHtcclxuICAgICAgICBuZXdUb3BpY05hbWVJbnB1dC5wYXJlbnRFbGVtZW50LmNsYXNzTGlzdC5hZGQoJ2Vycm9yJyk7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlXHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8qUmVtb3ZlIGlucHV0J3MgcmVkIGhpZ2hsaWdodCBhbmQgc2VuZCBuZXcgdG9waWMgbmFtZSB0byBzZXJ2ZXIqL1xyXG4gICAgICBuZXdUb3BpY05hbWVJbnB1dC5wYXJlbnRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ2Vycm9yJyk7XHJcbiAgICAgIHRtcERhdGFTZXJ2aWNlLmVkaXRUb3BpYyhjb3Vyc2VJZCwgY3VycmVudEVkaXRUb3BpY0lkLCBuYW1lKS50aGVuKGZ1bmN0aW9uICh7bXNnVGl0bGUsIG1zZ1RleHR9KSB7XHJcbiAgICAgICAgcGFyZW50LmpRdWVyeS5mYW5jeWJveC5nZXRJbnN0YW5jZSgpLmNsb3NlKCk7XHJcblxyXG4gICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgc2hvd01vZGFsTXNnKG1zZ1RpdGxlLCBtc2dUZXh0KTtcclxuICAgICAgICB9LCAzODApO1xyXG5cclxuICAgICAgICBsZXQgY3VycmVudE9iaiA9IGdldE9iamVjdEJ5SWQoY3VycmVudEVkaXRUb3BpY0lkLCBjb3Vyc2VEYXRhKTtcclxuICAgICAgICBjdXJyZW50T2JqLm5hbWUgPSBuYW1lO1xyXG5cclxuICAgICAgICByZW5kZXJEYXRhKCk7XHJcbiAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGVycm9yLm1lc3NhZ2UpO1xyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIHJlbW92ZVRvcGljQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKGUpIHtcclxuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICB0bXBEYXRhU2VydmljZS5yZW1vdmVUb3BpYyhjb3Vyc2VJZCwgY3VycmVudFJlbW92ZVRvcGljSWQpLnRoZW4oZnVuY3Rpb24gKHttc2dUaXRsZSwgbXNnVGV4dH0pIHtcclxuICAgICAgICBwYXJlbnQualF1ZXJ5LmZhbmN5Ym94LmdldEluc3RhbmNlKCkuY2xvc2UoKTtcclxuXHJcbiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICBzaG93TW9kYWxNc2cobXNnVGl0bGUsIG1zZ1RleHQpO1xyXG4gICAgICAgIH0sIDM4MCk7XHJcblxyXG4gICAgICAgIGxldCBjdXJyZW50T2JqSW5kZXggPSBnZXRJbmRleEJ5SWQoY3VycmVudFJlbW92ZVRvcGljSWQsIGNvdXJzZURhdGEpO1xyXG5cclxuICAgICAgICBjb3Vyc2VEYXRhLnNwbGljZShjdXJyZW50T2JqSW5kZXgsIDEpO1xyXG5cclxuICAgICAgICBmb3IgKGxldCBpID0gY3VycmVudE9iakluZGV4OyBpIDwgY291cnNlRGF0YS5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgY291cnNlRGF0YVtpXS5vcmRlci0tXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZW5kZXJEYXRhKCk7XHJcbiAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGVycm9yLm1lc3NhZ2UpO1xyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIHJlbW92ZUxlc3NvbkJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgdG1wRGF0YVNlcnZpY2UucmVtb3ZlTGVzc29uKGNvdXJzZUlkLCBjdXJyZW50UmVtb3ZlVG9waWNJZCwgY3VycmVudFJlbW92ZUxlc3NvbklkKS50aGVuKGZ1bmN0aW9uKHttc2dUaXRsZSwgbXNnVGV4dH0pIHtcclxuICAgICAgICBwYXJlbnQualF1ZXJ5LmZhbmN5Ym94LmdldEluc3RhbmNlKCkuY2xvc2UoKTtcclxuXHJcbiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICBzaG93TW9kYWxNc2cobXNnVGl0bGUsIG1zZ1RleHQpO1xyXG4gICAgICAgIH0sIDM4MCk7XHJcblxyXG4gICAgICAgIGxldCBsZXNzb25zID0gZ2V0T2JqZWN0QnlJZChjdXJyZW50UmVtb3ZlVG9waWNJZCwgY291cnNlRGF0YSkubGVzc29ucztcclxuXHJcbiAgICAgICAgbGV0IGN1cnJlbnRPYmpJbmRleCA9IGdldEluZGV4QnlJZChjdXJyZW50UmVtb3ZlTGVzc29uSWQsIGxlc3NvbnMpO1xyXG5cclxuICAgICAgICBsZXNzb25zLnNwbGljZShjdXJyZW50T2JqSW5kZXgsIDEpO1xyXG5cclxuICAgICAgICBmb3IgKGxldCBpID0gY3VycmVudE9iakluZGV4OyBpIDwgbGVzc29ucy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgbGVzc29uc1tpXS5vcmRlci0tXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZW5kZXJEYXRhKCk7XHJcbiAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGVycm9yLm1lc3NhZ2UpO1xyXG4gICAgICB9KVxyXG4gICAgfSk7XHJcblxyXG4gICAgdG1wRGF0YVNlcnZpY2UuZ2V0Q291cnNlRGF0YShjb3Vyc2VJZCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICBjb3Vyc2VEYXRhID0gWy4uLmRhdGFdO1xyXG4gICAgICByZW5kZXJEYXRhKCk7XHJcbiAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS5sb2coZXJyb3IubWVzc2FnZSk7XHJcbiAgICB9KTtcclxuICB9O1xyXG5cclxuICB0aGlzLnJlbmRlckRhdGEgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICByZW5kZXJEYXRhKCk7XHJcbiAgfTtcclxufTsiXSwiZmlsZSI6ImNvdXJzZS1lZGl0LmpzIn0=
