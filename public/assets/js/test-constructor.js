let TestConstructor=function({textAnswerTpl:e,picAnswerTpl:t,questionTpl:n}){function r(){let e=document.querySelector("#questionsCount"),t=document.querySelector("#passingScore"),n=o.children.length;e.innerHTML=n,t.value=Math.ceil(.8*n)}const c=document.querySelector("#addQuestion"),o=document.querySelector("#questions");let i=function(n){function c(){let t=document.createElement("div");t.innerHTML=e.replace("$answersName",`answers[${d}][]`);let n=t.querySelector(".form-group");t.querySelector(".addon").innerHTML="";let r=document.createElement("div");r.className="btn-icon extra-small icon-close",r.setAttribute("data-answer-remove",""),r.addEventListener("click",function(){n.remove()}),t.querySelector("input[required]").removeAttribute("required"),t.querySelector(".addon").append(r),s.append(t.children[0])}function o(){let e=document.createElement("div");e.innerHTML=t.replace("$answersName",`answers[${d}][]`);let n=e.querySelector(".form-group"),r=e.querySelector(".dropzone-multiple");e.querySelector(".addon").innerHTML="";let c=document.createElement("div");c.className="btn-icon extra-small icon-close",c.setAttribute("data-answer-remove",""),c.addEventListener("click",function(){n.remove()}),e.querySelector(".addon").append(c),e.querySelector("input[required]").removeAttribute("required"),s.append(e.children[0]),i(r)}function i(e){let t=e.dataset.url,n=+e.dataset.maxfiles,r=+e.dataset.maxsize,c=e.dataset.acceptedfiles;new CustomDropzone(e,t,n,r,c,"image/*"===c)}function a(){let t=e.replace("$answersName",`answers[${d}][]`);s.innerHTML=t+t}const l=n.querySelector("[data-question-remove]"),u=n.querySelector('input[type="checkbox"]'),s=n.querySelector(".answers"),d=n.querySelector(".question-text").name.replace(/(^.*\[|\].*$)/g,""),m=n.querySelector(".add-btn");TinyMceInit(".tinymce-here"),l&&l.addEventListener("click",function(){n.remove(),r()}),u.checked?m.addEventListener("click",o):m.addEventListener("click",c),u.addEventListener("change",function(e){s.innerHTML="",e.target.checked?(function(){let e=t.replace("$answersName",`answers[${d}][]`);s.innerHTML=e+e,s.querySelectorAll(".dropzone-multiple").forEach(function(e){i(e)})}(),m.removeEventListener("click",c),m.addEventListener("click",o)):(a(),m.removeEventListener("click",o),m.addEventListener("click",c))}),this.appendRequiredTextAnswers=function(){a()},n.querySelectorAll("[data-answer-remove]").forEach(function(e){e.addEventListener("click",function(){e.closest(".form-group").remove()})})};document.querySelectorAll(".question").forEach(function(e){i(e)}),c.addEventListener("click",function(e){e.preventDefault();let t=+o.lastElementChild.querySelector(".question-text").name.replace(/(^.*\[|\].*$)/g,"")+1,c=n.replace("$questionName",`questions[${t}]`).replace("$isPicturesIndex",t),a=document.createElement("div");a.className="question form-group",a.innerHTML=c;let l=document.createElement("div");l.className="btn-icon small icon-close",l.setAttribute("data-question-remove",""),l.addEventListener("click",function(){a.remove()}),a.querySelector(".addon-btn").innerHTML="",a.querySelector(".addon-btn").append(l),o.appendChild(a),new i(a).appendRequiredTextAnswers(),r()}),r()};
