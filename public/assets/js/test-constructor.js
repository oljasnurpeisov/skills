let TestConstructor=function({textAnswerTpl:a,picAnswerTpl:b,questionTpl:c}){function d(){let a=document.querySelector("#questionsCount"),b=document.querySelector("#passingScore"),c=f.children.length;a.innerHTML=c,b.value=Math.ceil(.8*c)}const e=document.querySelector("#addQuestion"),f=document.querySelector("#questions");let g=function(c){function f(){let b=document.createElement("div");b.innerHTML=a.replace("$answersName",`answers[${o}][]`);let c=b.querySelector(".form-group");b.querySelector(".addon").innerHTML="";let d=document.createElement("div");d.className="btn-icon extra-small icon-close",d.setAttribute("data-answer-remove",""),d.addEventListener("click",function(){c.remove()}),b.querySelector("input[required]").removeAttribute("required"),b.querySelector(".addon").append(d),m.append(b.children[0])}function g(){let a=document.createElement("div");a.innerHTML=b.replace("$answersName",`answers[${o}][]`);let c=a.querySelector(".form-group"),d=a.querySelector(".dropzone-multiple");a.querySelector(".addon").innerHTML="";let e=document.createElement("div");e.className="btn-icon extra-small icon-close",e.setAttribute("data-answer-remove",""),e.addEventListener("click",function(){c.remove()}),a.querySelector(".addon").append(e),a.querySelector("input[required]").removeAttribute("required"),m.append(a.children[0]),h(d)}function h(a){let b=a.dataset.url,c=+a.dataset.maxfiles,d=+a.dataset.maxsize,e=a.dataset.acceptedfiles,f=new CustomDropzone(a,b,c,d,e,"image/*"===e)}function i(){let b=a.replace("$answersName",`answers[${o}][]`);m.innerHTML=b+b}function j(){let a=b.replace("$answersName",`answers[${o}][]`);m.innerHTML=a+a,m.querySelectorAll(".dropzone-multiple").forEach(function(a){h(a)})}const k=c.querySelector("[data-question-remove]"),l=c.querySelector("input[type=\"checkbox\"]"),m=c.querySelector(".answers"),n=c.querySelector(".question-text"),o=n.name.replace(/(^.*\[|\].*$)/g,""),p=c.querySelector(".add-btn"),q=this;TinyMceInit(".tinymce-here"),k&&k.addEventListener("click",function(){c.remove(),d()}),l.checked?p.addEventListener("click",g):p.addEventListener("click",f),l.addEventListener("change",function(a){m.innerHTML="",a.target.checked?(j(),p.removeEventListener("click",f),p.addEventListener("click",g)):(i(),p.removeEventListener("click",g),p.addEventListener("click",f))}),this.appendRequiredTextAnswers=function(){i()},c.querySelectorAll("[data-answer-remove]").forEach(function(a){a.addEventListener("click",function(){a.closest(".form-group").remove()})})};document.querySelectorAll(".question").forEach(function(a){g(a)}),e.addEventListener("click",function(a){a.preventDefault();let b=f.lastElementChild.querySelector(".question-text"),e=+b.name.replace(/(^.*\[|\].*$)/g,"")+1,h=c.replace("$questionName",`questions[${e}]`).replace("$isPicturesIndex",e),i=document.createElement("div");i.className="question form-group",i.innerHTML=h;let j=document.createElement("div");j.className="btn-icon small icon-close",j.setAttribute("data-question-remove",""),j.addEventListener("click",function(){i.remove()}),i.querySelector(".addon-btn").innerHTML="",i.querySelector(".addon-btn").append(j),f.appendChild(i);let k=new g(i);k.appendRequiredTextAnswers(),d()}),d()};
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInRlc3QtY29uc3RydWN0b3IuanMiXSwibmFtZXMiOlsiVGVzdENvbnN0cnVjdG9yIiwidGV4dEFuc3dlclRwbCIsInBpY0Fuc3dlclRwbCIsInF1ZXN0aW9uVHBsIiwidXBkYXRlQW5zd2Vyc0NvdW50IiwicXVlc3Rpb25zQ291bnQiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJwYXNzaW5nU2NvcmUiLCJ0b3RhbCIsInF1ZXN0aW9uc1dyYXBwZXIiLCJjaGlsZHJlbiIsImxlbmd0aCIsImlubmVySFRNTCIsInZhbHVlIiwiTWF0aCIsImNlaWwiLCJhZGRRdWVzdGlvbkJ0biIsIlF1ZXN0aW9uQ29tcG9uZW50IiwiZWwiLCJhZGRUZXh0QW5zd2VyIiwibmV3QW5zd2VyIiwiY3JlYXRlRWxlbWVudCIsInJlcGxhY2UiLCJxdWVzdGlvbkluZGV4IiwiZm9ybUdyb3VwIiwicmVtb3ZlQnRuIiwiY2xhc3NOYW1lIiwic2V0QXR0cmlidXRlIiwiYWRkRXZlbnRMaXN0ZW5lciIsInJlbW92ZSIsInJlbW92ZUF0dHJpYnV0ZSIsImFwcGVuZCIsImFuc3dlcnNDb250YWluZXIiLCJhZGRQaWNBbnN3ZXIiLCJkcm9wem9uZUVsIiwiaW5pdERyb3B6b25lIiwiaXRlbSIsInVybCIsImRhdGFzZXQiLCJtYXhGaWxlcyIsIm1heGZpbGVzIiwibWF4U2l6ZSIsIm1heHNpemUiLCJhY2NlcHRlZEZpbGVzIiwiYWNjZXB0ZWRmaWxlcyIsImNyZWF0ZURyb3B6b25lIiwiQ3VzdG9tRHJvcHpvbmUiLCJhcHBlbmRSZXF1aXJlZFRleHRBbnN3ZXJzIiwidHBsIiwiYXBwZW5kUmVxdWlyZWRQaWNBbnN3ZXJzIiwicXVlcnlTZWxlY3RvckFsbCIsImZvckVhY2giLCJhbnN3ZXJzVHlwZUNoZWNrYm94IiwicXVlc3Rpb25UZXh0SW5wdXQiLCJuYW1lIiwiYWRkQW5zd2VyQnRuIiwic2VsZiIsIlRpbnlNY2VJbml0IiwiY2hlY2tlZCIsImUiLCJ0YXJnZXQiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiYnRuIiwiY2xvc2VzdCIsInByZXZlbnREZWZhdWx0IiwibGFzdEVsZW1lbnRDaGlsZCIsIm5ld1F1ZXN0aW9uIiwicmVtb3ZlUXVlc3Rpb25CdG4iLCJhcHBlbmRDaGlsZCIsIm5ld1F1ZXN0aW9uQ29tcG9uZW50Il0sIm1hcHBpbmdzIjoiQUFBQSxHQUFJQSxDQUFBQSxlQUFlLENBQUcsU0FBVSxDQUFDQyxhQUFhLENBQWJBLENBQUQsQ0FBZ0JDLFlBQVksQ0FBWkEsQ0FBaEIsQ0FBOEJDLFdBQVcsQ0FBWEEsQ0FBOUIsQ0FBVixDQUFzRCxDQWtLMUUsUUFBU0MsQ0FBQUEsQ0FBVCxFQUE4QixDQUM1QixHQUFJQyxDQUFBQSxDQUFjLENBQUdDLFFBQVEsQ0FBQ0MsYUFBVCxDQUF1QixpQkFBdkIsQ0FBckIsQ0FDRUMsQ0FBWSxDQUFHRixRQUFRLENBQUNDLGFBQVQsQ0FBdUIsZUFBdkIsQ0FEakIsQ0FFRUUsQ0FBSyxDQUFHQyxDQUFnQixDQUFDQyxRQUFqQixDQUEwQkMsTUFGcEMsQ0FHQVAsQ0FBYyxDQUFDUSxTQUFmLENBQTJCSixDQUpDLENBSzVCRCxDQUFZLENBQUNNLEtBQWIsQ0FBcUJDLElBQUksQ0FBQ0MsSUFBTCxDQUFnQixFQUFOLENBQUFQLENBQVYsQ0FDdEIsQ0F4S3lFLEtBQ3BFUSxDQUFBQSxDQUFjLENBQUdYLFFBQVEsQ0FBQ0MsYUFBVCxDQUF1QixjQUF2QixDQURtRCxDQUVwRUcsQ0FBZ0IsQ0FBR0osUUFBUSxDQUFDQyxhQUFULENBQXVCLFlBQXZCLENBRmlELENBSTFFLEdBQUlXLENBQUFBLENBQWlCLENBQUcsU0FBVUMsQ0FBVixDQUFjLENBd0NwQyxRQUFTQyxDQUFBQSxDQUFULEVBQXlCLENBQ3ZCLEdBQUlDLENBQUFBLENBQVMsQ0FBR2YsUUFBUSxDQUFDZ0IsYUFBVCxDQUF1QixLQUF2QixDQUFoQixDQUNBRCxDQUFTLENBQUNSLFNBQVYsQ0FBc0JaLENBQWEsQ0FBQ3NCLE9BQWQsQ0FBc0IsY0FBdEIsQ0FBdUMsV0FBVUMsQ0FBYyxLQUEvRCxD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QyxDQUFvRCxFQXJCQSxDQXNCcERzRCxDQUFXLENBQUM1RCxhQUFaLENBQTBCLFlBQTFCLEVBQXdDeUIsTUFBeEMsQ0FBK0NvQyxDQUEvQyxDQXRCb0QsQ0F3QnBEMUQsQ0FBZ0IsQ0FBQzJELFdBQWpCLENBQTZCRixDQUE3QixDQXhCb0QsQ0EwQnBELEdBQUlHLENBQUFBLENBQW9CLENBQUcsR0FBSXBELENBQUFBLENBQUosQ0FBc0JpRCxDQUF0QixDQUEzQixDQUNBRyxDQUFvQixDQUFDdEIseUJBQXJCLEVBM0JvRCxDQTZCcEQ1QyxDQUFrQixFQUNuQixDQTlCRCxDQWxJMEUsQ0EwSzFFQSxDQUFrQixFQUNuQixDQTNLRCIsInNvdXJjZXNDb250ZW50IjpbImxldCBUZXN0Q29uc3RydWN0b3IgPSBmdW5jdGlvbiAoe3RleHRBbnN3ZXJUcGwsIHBpY0Fuc3dlclRwbCwgcXVlc3Rpb25UcGx9KSB7XHJcbiAgY29uc3QgYWRkUXVlc3Rpb25CdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjYWRkUXVlc3Rpb24nKTtcclxuICBjb25zdCBxdWVzdGlvbnNXcmFwcGVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3F1ZXN0aW9ucycpO1xyXG5cclxuICBsZXQgUXVlc3Rpb25Db21wb25lbnQgPSBmdW5jdGlvbiAoZWwpIHtcclxuICAgIGNvbnN0IHJlbW92ZUJ0biA9IGVsLnF1ZXJ5U2VsZWN0b3IoJ1tkYXRhLXF1ZXN0aW9uLXJlbW92ZV0nKSxcclxuICAgICAgYW5zd2Vyc1R5cGVDaGVja2JveCA9IGVsLnF1ZXJ5U2VsZWN0b3IoJ2lucHV0W3R5cGU9XCJjaGVja2JveFwiXScpLFxyXG4gICAgICBhbnN3ZXJzQ29udGFpbmVyID0gZWwucXVlcnlTZWxlY3RvcignLmFuc3dlcnMnKSxcclxuICAgICAgcXVlc3Rpb25UZXh0SW5wdXQgPSBlbC5xdWVyeVNlbGVjdG9yKCcucXVlc3Rpb24tdGV4dCcpLFxyXG4gICAgICBxdWVzdGlvbkluZGV4ID0gcXVlc3Rpb25UZXh0SW5wdXQubmFtZS5yZXBsYWNlKC8oXi4qXFxbfFxcXS4qJCkvZywgJycpLFxyXG4gICAgICBhZGRBbnN3ZXJCdG4gPSBlbC5xdWVyeVNlbGVjdG9yKCcuYWRkLWJ0bicpLFxyXG4gICAgICBzZWxmID0gdGhpcztcclxuXHJcbiAgICBUaW55TWNlSW5pdCgnLnRpbnltY2UtaGVyZScpO1xyXG5cclxuICAgIC8vUmVtb3ZlIEJ0biBldmVudFxyXG4gICAgaWYgKHJlbW92ZUJ0bikge1xyXG4gICAgICByZW1vdmVCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgZWwucmVtb3ZlKCk7XHJcbiAgICAgICAgdXBkYXRlQW5zd2Vyc0NvdW50KCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIGlmICghYW5zd2Vyc1R5cGVDaGVja2JveC5jaGVja2VkKSB7XHJcbiAgICAgIGFkZEFuc3dlckJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGFkZFRleHRBbnN3ZXIpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgYWRkQW5zd2VyQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgYWRkUGljQW5zd2VyKTtcclxuICAgIH1cclxuXHJcbiAgICAvL0NoZWNrYm94IGV2ZW50XHJcbiAgICBhbnN3ZXJzVHlwZUNoZWNrYm94LmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgIGFuc3dlcnNDb250YWluZXIuaW5uZXJIVE1MID0gJyc7XHJcblxyXG4gICAgICBpZiAoZS50YXJnZXQuY2hlY2tlZCkge1xyXG4gICAgICAgIGFwcGVuZFJlcXVpcmVkUGljQW5zd2VycygpO1xyXG4gICAgICAgIGFkZEFuc3dlckJ0bi5yZW1vdmVFdmVudExpc3RlbmVyKCdjbGljaycsIGFkZFRleHRBbnN3ZXIpO1xyXG4gICAgICAgIGFkZEFuc3dlckJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGFkZFBpY0Fuc3dlcik7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgYXBwZW5kUmVxdWlyZWRUZXh0QW5zd2VycygpO1xyXG4gICAgICAgIGFkZEFuc3dlckJ0bi5yZW1vdmVFdmVudExpc3RlbmVyKCdjbGljaycsIGFkZFBpY0Fuc3dlcik7XHJcbiAgICAgICAgYWRkQW5zd2VyQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgYWRkVGV4dEFuc3dlcik7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIGZ1bmN0aW9uIGFkZFRleHRBbnN3ZXIoKSB7XHJcbiAgICAgIGxldCBuZXdBbnN3ZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgICAgbmV3QW5zd2VyLmlubmVySFRNTCA9IHRleHRBbnN3ZXJUcGwucmVwbGFjZSgnJGFuc3dlcnNOYW1lJywgYGFuc3dlcnNbJHtxdWVzdGlvbkluZGV4fV1bXWApO1xyXG5cclxuICAgICAgbGV0IGZvcm1Hcm91cCA9IG5ld0Fuc3dlci5xdWVyeVNlbGVjdG9yKCcuZm9ybS1ncm91cCcpO1xyXG5cclxuICAgICAgbmV3QW5zd2VyLnF1ZXJ5U2VsZWN0b3IoJy5hZGRvbicpLmlubmVySFRNTCA9ICcnO1xyXG5cclxuICAgICAgbGV0IHJlbW92ZUJ0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgICByZW1vdmVCdG4uY2xhc3NOYW1lID0gJ2J0bi1pY29uIGV4dHJhLXNtYWxsIGljb24tY2xvc2UnO1xyXG4gICAgICByZW1vdmVCdG4uc2V0QXR0cmlidXRlKCdkYXRhLWFuc3dlci1yZW1vdmUnLCAnJyk7XHJcblxyXG4gICAgICByZW1vdmVCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgZm9ybUdyb3VwLnJlbW92ZSgpO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIG5ld0Fuc3dlci5xdWVyeVNlbGVjdG9yKCdpbnB1dFtyZXF1aXJlZF0nKS5yZW1vdmVBdHRyaWJ1dGUoJ3JlcXVpcmVkJyk7XHJcblxyXG4gICAgICBuZXdBbnN3ZXIucXVlcnlTZWxlY3RvcignLmFkZG9uJykuYXBwZW5kKHJlbW92ZUJ0bik7XHJcblxyXG4gICAgICBhbnN3ZXJzQ29udGFpbmVyLmFwcGVuZChuZXdBbnN3ZXIuY2hpbGRyZW5bMF0pO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGFkZFBpY0Fuc3dlcigpIHtcclxuICAgICAgbGV0IG5ld0Fuc3dlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgICBuZXdBbnN3ZXIuaW5uZXJIVE1MID0gcGljQW5zd2VyVHBsLnJlcGxhY2UoJyRhbnN3ZXJzTmFtZScsIGBhbnN3ZXJzWyR7cXVlc3Rpb25JbmRleH1dW11gKTtcclxuXHJcbiAgICAgIGxldCBmb3JtR3JvdXAgPSBuZXdBbnN3ZXIucXVlcnlTZWxlY3RvcignLmZvcm0tZ3JvdXAnKTtcclxuICAgICAgbGV0IGRyb3B6b25lRWwgPSBuZXdBbnN3ZXIucXVlcnlTZWxlY3RvcignLmRyb3B6b25lLW11bHRpcGxlJyk7XHJcblxyXG4gICAgICBuZXdBbnN3ZXIucXVlcnlTZWxlY3RvcignLmFkZG9uJykuaW5uZXJIVE1MID0gJyc7XHJcblxyXG4gICAgICBsZXQgcmVtb3ZlQnRuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICAgIHJlbW92ZUJ0bi5jbGFzc05hbWUgPSAnYnRuLWljb24gZXh0cmEtc21hbGwgaWNvbi1jbG9zZSc7XHJcbiAgICAgIHJlbW92ZUJ0bi5zZXRBdHRyaWJ1dGUoJ2RhdGEtYW5zd2VyLXJlbW92ZScsICcnKTtcclxuXHJcbiAgICAgIHJlbW92ZUJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBmb3JtR3JvdXAucmVtb3ZlKCk7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgbmV3QW5zd2VyLnF1ZXJ5U2VsZWN0b3IoJy5hZGRvbicpLmFwcGVuZChyZW1vdmVCdG4pO1xyXG5cclxuICAgICAgbmV3QW5zd2VyLnF1ZXJ5U2VsZWN0b3IoJ2lucHV0W3JlcXVpcmVkXScpLnJlbW92ZUF0dHJpYnV0ZSgncmVxdWlyZWQnKTtcclxuXHJcbiAgICAgIGFuc3dlcnNDb250YWluZXIuYXBwZW5kKG5ld0Fuc3dlci5jaGlsZHJlblswXSk7XHJcblxyXG4gICAgICBpbml0RHJvcHpvbmUoZHJvcHpvbmVFbCk7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gaW5pdERyb3B6b25lKGl0ZW0pIHtcclxuICAgICAgbGV0IHVybCA9IGl0ZW0uZGF0YXNldC51cmwsXHJcbiAgICAgICAgbWF4RmlsZXMgPSBOdW1iZXIoaXRlbS5kYXRhc2V0Lm1heGZpbGVzKSxcclxuICAgICAgICBtYXhTaXplID0gTnVtYmVyKGl0ZW0uZGF0YXNldC5tYXhzaXplKSxcclxuICAgICAgICBhY2NlcHRlZEZpbGVzID0gaXRlbS5kYXRhc2V0LmFjY2VwdGVkZmlsZXM7XHJcbiAgICAgIGxldCBjcmVhdGVEcm9wem9uZSA9IG5ldyBDdXN0b21Ecm9wem9uZShpdGVtLCB1cmwsIG1heEZpbGVzLCBtYXhTaXplLCBhY2NlcHRlZEZpbGVzLCBhY2NlcHRlZEZpbGVzID09PSAnaW1hZ2UvKicpO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGFwcGVuZFJlcXVpcmVkVGV4dEFuc3dlcnMgKCkge1xyXG4gICAgICBsZXQgdHBsID0gdGV4dEFuc3dlclRwbC5yZXBsYWNlKCckYW5zd2Vyc05hbWUnLCBgYW5zd2Vyc1ske3F1ZXN0aW9uSW5kZXh9XVtdYCk7XHJcbiAgICAgIGFuc3dlcnNDb250YWluZXIuaW5uZXJIVE1MID0gdHBsICsgdHBsO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGFwcGVuZFJlcXVpcmVkUGljQW5zd2VycyAoKSB7XHJcbiAgICAgIGxldCB0cGwgPSBwaWNBbnN3ZXJUcGwucmVwbGFjZSgnJGFuc3dlcnNOYW1lJywgYGFuc3dlcnNbJHtxdWVzdGlvbkluZGV4fV1bXWApO1xyXG4gICAgICBhbnN3ZXJzQ29udGFpbmVyLmlubmVySFRNTCA9IHRwbCArIHRwbDtcclxuXHJcbiAgICAgIGFuc3dlcnNDb250YWluZXIucXVlcnlTZWxlY3RvckFsbCgnLmRyb3B6b25lLW11bHRpcGxlJykuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkge1xyXG4gICAgICAgIGluaXREcm9wem9uZShpdGVtKTtcclxuICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgdGhpcy5hcHBlbmRSZXF1aXJlZFRleHRBbnN3ZXJzID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICBhcHBlbmRSZXF1aXJlZFRleHRBbnN3ZXJzKCk7XHJcbiAgICB9O1xyXG5cclxuICAgIGVsLnF1ZXJ5U2VsZWN0b3JBbGwoJ1tkYXRhLWFuc3dlci1yZW1vdmVdJykuZm9yRWFjaChmdW5jdGlvbiAoYnRuKSB7XHJcbiAgICAgIGJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBidG4uY2xvc2VzdCgnLmZvcm0tZ3JvdXAnKS5yZW1vdmUoKTtcclxuICAgICAgfSk7XHJcbiAgICB9KVxyXG4gIH07XHJcblxyXG4gIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5xdWVzdGlvbicpLmZvckVhY2goZnVuY3Rpb24gKGVsKSB7XHJcbiAgICBsZXQgbmV3UXVlc3Rpb25Db21wb25lbnQgPSBRdWVzdGlvbkNvbXBvbmVudChlbCk7XHJcbiAgfSk7XHJcblxyXG4gIGFkZFF1ZXN0aW9uQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKGUpIHtcclxuICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuXHJcbiAgICBsZXQgcXVlc3Rpb25UZXh0SW5wdXQgPSBxdWVzdGlvbnNXcmFwcGVyLmxhc3RFbGVtZW50Q2hpbGQucXVlcnlTZWxlY3RvcignLnF1ZXN0aW9uLXRleHQnKSxcclxuICAgICAgcXVlc3Rpb25JbmRleCA9IE51bWJlcihxdWVzdGlvblRleHRJbnB1dC5uYW1lLnJlcGxhY2UoLyheLipcXFt8XFxdLiokKS9nLCAnJykpICsgMTtcclxuXHJcbiAgICBsZXQgdHBsID0gcXVlc3Rpb25UcGwucmVwbGFjZSgnJHF1ZXN0aW9uTmFtZScsIGBxdWVzdGlvbnNbJHtxdWVzdGlvbkluZGV4fV1gKVxyXG4gICAgICAucmVwbGFjZSgnJGlzUGljdHVyZXNJbmRleCcsIHF1ZXN0aW9uSW5kZXgpO1xyXG5cclxuICAgIGxldCBuZXdRdWVzdGlvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgbmV3UXVlc3Rpb24uY2xhc3NOYW1lID0gJ3F1ZXN0aW9uIGZvcm0tZ3JvdXAnO1xyXG4gICAgbmV3UXVlc3Rpb24uaW5uZXJIVE1MID0gdHBsO1xyXG5cclxuICAgIGxldCByZW1vdmVRdWVzdGlvbkJ0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgcmVtb3ZlUXVlc3Rpb25CdG4uY2xhc3NOYW1lID0gJ2J0bi1pY29uIHNtYWxsIGljb24tY2xvc2UnO1xyXG4gICAgcmVtb3ZlUXVlc3Rpb25CdG4uc2V0QXR0cmlidXRlKCdkYXRhLXF1ZXN0aW9uLXJlbW92ZScsICcnKTtcclxuXHJcbiAgICByZW1vdmVRdWVzdGlvbkJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgbmV3UXVlc3Rpb24ucmVtb3ZlKCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBuZXdRdWVzdGlvbi5xdWVyeVNlbGVjdG9yKCcuYWRkb24tYnRuJykuaW5uZXJIVE1MID0gJyc7XHJcbiAgICBuZXdRdWVzdGlvbi5xdWVyeVNlbGVjdG9yKCcuYWRkb24tYnRuJykuYXBwZW5kKHJlbW92ZVF1ZXN0aW9uQnRuKTtcclxuXHJcbiAgICBxdWVzdGlvbnNXcmFwcGVyLmFwcGVuZENoaWxkKG5ld1F1ZXN0aW9uKTtcclxuXHJcbiAgICBsZXQgbmV3UXVlc3Rpb25Db21wb25lbnQgPSBuZXcgUXVlc3Rpb25Db21wb25lbnQobmV3UXVlc3Rpb24pO1xyXG4gICAgbmV3UXVlc3Rpb25Db21wb25lbnQuYXBwZW5kUmVxdWlyZWRUZXh0QW5zd2VycygpO1xyXG5cclxuICAgIHVwZGF0ZUFuc3dlcnNDb3VudCgpO1xyXG4gIH0pO1xyXG5cclxuICBmdW5jdGlvbiB1cGRhdGVBbnN3ZXJzQ291bnQoKSB7XHJcbiAgICBsZXQgcXVlc3Rpb25zQ291bnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjcXVlc3Rpb25zQ291bnQnKSxcclxuICAgICAgcGFzc2luZ1Njb3JlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3Bhc3NpbmdTY29yZScpLFxyXG4gICAgICB0b3RhbCA9IHF1ZXN0aW9uc1dyYXBwZXIuY2hpbGRyZW4ubGVuZ3RoO1xyXG4gICAgcXVlc3Rpb25zQ291bnQuaW5uZXJIVE1MID0gdG90YWw7XHJcbiAgICBwYXNzaW5nU2NvcmUudmFsdWUgPSBNYXRoLmNlaWwodG90YWwqMC44KTtcclxuICB9XHJcblxyXG4gIHVwZGF0ZUFuc3dlcnNDb3VudCgpO1xyXG59OyJdLCJmaWxlIjoidGVzdC1jb25zdHJ1Y3Rvci5qcyJ9
